{"version":3,"file":"index.ts-arZNZrkf.js","sources":["../../src/pages/background/index.ts"],"sourcesContent":["import type { AutoCommentingState } from \"./background-types\";\nimport { AICommentGenerator } from \"./ai-comment-generator\";\nimport { MessageRouter } from \"./message-router\";\n\nconsole.log(\"background script loaded\");\n\nlet autoCommentingState: AutoCommentingState = {\n  isRunning: false,\n  styleGuide: \"\",\n  apiKey: \"\",\n  scrollDuration: 10,\n  commentDelay: 10,\n  maxPosts: 20,\n  duplicateWindow: 24,\n  commentCount: 0,\n};\n\n// Utility function to wait for a specified time\nconst waitBackground = (ms: number): Promise<void> => {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n};\n\n// Function to send status updates to popup\nconst sendStatusUpdate = (\n  status: string,\n  updates: Partial<AutoCommentingState> = {},\n) => {\n  try {\n    chrome.runtime.sendMessage({\n      action: \"statusUpdate\",\n      status,\n      commentCount: autoCommentingState.commentCount,\n      isRunning: autoCommentingState.isRunning,\n      ...updates,\n    });\n\n    // Also save state to storage for persistence\n    chrome.storage.local.set({\n      isRunning: autoCommentingState.isRunning,\n      currentCommentCount: autoCommentingState.commentCount,\n    });\n  } catch (error) {\n    console.error(\"Error sending status update:\", error);\n  }\n};\n\n// Function to update today's comment count\nconst updateTodayComments = (newCount: number) => {\n  const today = new Date().toDateString();\n  const storageKey = `comments_today_${today}`;\n\n  chrome.storage.local.get([storageKey], (result) => {\n    const currentTodayCount = result[storageKey] || 0;\n    const updatedTodayCount = currentTodayCount + newCount;\n    chrome.storage.local.set({ [storageKey]: updatedTodayCount });\n\n    // Send updated today total to popup\n    try {\n      chrome.runtime.sendMessage({\n        action: \"statusUpdate\",\n        newTodayTotal: updatedTodayCount,\n      });\n    } catch (error) {\n      console.error(\"Error sending today total update:\", error);\n    }\n  });\n};\n\n// Function to generate comment using AI\nconst generateCommentBackground = async (\n  postContent: string,\n): Promise<string> => {\n  console.log(\n    \"Background: Starting comment generation for content length:\",\n    postContent?.length || 0,\n  );\n\n  const ai = new GoogleGenAI({ apiKey: autoCommentingState.apiKey });\n\n  const systemPrompt = `\n  You are a LinkedIn influencer commenting on a post. \n  \n  Generate concise but engaging comments for a single LinkedIn. \n\n  Super Importantly, ONLY REPSOND WITH THE COMMENT. DO NOT REPLY WITH ANYTHING ELSE LIKE QUOTATIONS OR ANYTHING ELSE.\n  \n  You must ahere to the style guide: ${autoCommentingState.styleGuide}. \n  \n  Importantly, ahere strictly to the following additional rules:\n  - Keep comments professional yet conversational\n  - under 100 words\n  - avoid generic responses.\n\n  Super Importantly, ONLY REPSOND WITH THE COMMENT. DO NOT REPLY WITH ANYTHING ELSE LIKE QUOTATIONS OR ANYTHING ELSE.\n\n  Generate a thoughtful comment for this LinkedIn post: ${postContent}\n\n  Super Importantly, ONLY REPSOND WITH THE COMMENT. DO NOT REPLY WITH ANYTHING ELSE LIKE QUOTATIONS OR ANYTHING ELSE.\n\n  Super Importantly, do not return any artefacts that might imply that the comment was generated by AI like placeholders [First's Name] or [Post Content].\n\n  The postContent above likely starts with the author's name. Address the author's name somewhere in your comment. If you can't find a name, don't try to put in placeholder, just don't address them.\n\n  It's important that you think very hard to make sure that what you return is as natural and human sounding/looking as possible without raising any red flags.\n\n  `;\n\n  try {\n    const response = await ai.models.generateContent({\n      model: \"gemini-2.0-flash-lite\",\n      contents: systemPrompt,\n      config: {\n        maxOutputTokens: 100,\n        temperature: 0.7,\n      },\n    });\n\n    const generatedComment = response.text || \"Great post! Thanks for sharing.\";\n\n    console.log(\n      \"Background: Successfully generated comment:\",\n      generatedComment.substring(0, 100) + \"...\",\n    );\n    return generatedComment;\n  } catch (error) {\n    const errorDetails = {\n      message: error instanceof Error ? error.message : String(error),\n      stack: error instanceof Error ? error.stack : undefined,\n      name: error instanceof Error ? error.name : \"Unknown\",\n      apiKey: autoCommentingState.apiKey ? \"Present\" : \"Missing\",\n      styleGuide: autoCommentingState.styleGuide ? \"Present\" : \"Missing\",\n      postContentLength: postContent ? postContent.length : 0,\n      timestamp: new Date().toISOString(),\n    };\n\n    console.error(\"Background: Error generating comment:\", errorDetails);\n\n    // Send detailed error to content script via message\n    try {\n      chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {\n        if (tabs[0]?.id) {\n          chrome.tabs.sendMessage(tabs[0].id, {\n            action: \"statusUpdate\",\n            error: errorDetails,\n          });\n        }\n      });\n    } catch (msgError) {\n      console.error(\n        \"Background: Failed to send error message to content script:\",\n        msgError,\n      );\n    }\n\n    // Re-throw the error so it can be caught by the promise handler\n    throw error;\n  }\n};\n\n// Main function to start auto-commenting with background window support\nconst startAutoCommenting = async (\n  styleGuide: string,\n  apiKey: string,\n  scrollDuration: number,\n  commentDelay: number,\n  maxPosts: number,\n  duplicateWindow: number,\n): Promise<void> => {\n  try {\n    // Reset and initialize state\n    autoCommentingState.styleGuide = styleGuide;\n    autoCommentingState.apiKey = apiKey;\n    autoCommentingState.scrollDuration = scrollDuration;\n    autoCommentingState.commentDelay = commentDelay;\n    autoCommentingState.maxPosts = maxPosts;\n    autoCommentingState.duplicateWindow = duplicateWindow;\n    autoCommentingState.isRunning = true;\n    autoCommentingState.commentCount = 0;\n\n    console.log(`Starting LinkedIn auto-commenting process...`);\n    sendStatusUpdate(`Starting LinkedIn auto-commenting...`);\n\n    // Get the current active tab to remember as the original tab\n    const currentTabs = await chrome.tabs.query({\n      active: true,\n      currentWindow: true,\n    });\n    if (currentTabs.length > 0 && currentTabs[0].id) {\n      autoCommentingState.originalTabId = currentTabs[0].id;\n      console.log(\n        `Captured original tab ID: ${autoCommentingState.originalTabId}`,\n      );\n    }\n\n    let feedTab: chrome.tabs.Tab | undefined;\n\n    // Create LinkedIn tab in current window instead of new background window\n    console.log(\"Creating LinkedIn tab in current window...\");\n    sendStatusUpdate(\"Creating LinkedIn tab for automation...\");\n\n    feedTab = await chrome.tabs.create({\n      url: \"https://www.linkedin.com/feed/\",\n      active: true, // Start with focus so user can see it\n      pinned: true, // Pin the tab to provide exemption from throttling\n    });\n\n    if (!feedTab || !feedTab.id) {\n      throw new Error(\"Failed to create LinkedIn feed tab\");\n    }\n\n    autoCommentingState.feedTabId = feedTab.id;\n    console.log(`LinkedIn tab created with ID: ${feedTab.id}`);\n    console.log(`LinkedIn tab pinned status: ${feedTab.pinned}`);\n    sendStatusUpdate(\n      \"LinkedIn tab created successfully as pinned tab (anti-throttling)...\",\n    );\n\n    sendStatusUpdate(\"Waiting for LinkedIn page to load...\");\n\n    // Don't show start button immediately - wait for content script to signal ready\n    // The content script will send 'pageReady' when DOM is loaded and LinkedIn feed is ready\n    console.log(\"Waiting for content script to signal page ready...\");\n  } catch (error) {\n    console.error(\"Error in auto-commenting process:\", error);\n    autoCommentingState.isRunning = false;\n    // No need to cleanup background window since we're using tabs now\n    sendStatusUpdate(\"Error occurred during auto-commenting setup\", {\n      isRunning: false,\n    });\n  }\n};\n\n// Message listener\nchrome.runtime.onMessage.addListener((request, sender, sendResponse) => {\n  if (request.action === \"backgroundLog\") {\n    // Handle logging from content script to background console\n    const timestamp = new Date().toLocaleTimeString();\n    const tabInfo = sender.tab ? `[Tab ${sender.tab.id}]` : \"[Unknown Tab]\";\n\n    switch (request.level) {\n      case \"error\":\n        console.error(`${timestamp} ${tabInfo} CONTENT:`, ...request.args);\n        break;\n      case \"warn\":\n        console.warn(`${timestamp} ${tabInfo} CONTENT:`, ...request.args);\n        break;\n      case \"group\":\n        console.group(`${timestamp} ${tabInfo} CONTENT:`, ...request.args);\n        break;\n      case \"groupEnd\":\n        console.groupEnd();\n        break;\n      default:\n        console.log(`${timestamp} ${tabInfo} CONTENT:`, ...request.args);\n        break;\n    }\n\n    sendResponse({ success: true });\n  } else if (request.action === \"startAutoCommenting\") {\n    console.log(\"Background: Received startAutoCommenting with settings:\", {\n      scrollDuration: request.scrollDuration,\n      commentDelay: request.commentDelay,\n      maxPosts: request.maxPosts,\n      duplicateWindow: request.duplicateWindow,\n      styleGuide: request.styleGuide?.substring(0, 50) + \"...\",\n      hasApiKey: !!request.apiKey,\n    });\n\n    // Also save the current settings to storage for persistence\n    const settingsToSave = {\n      apiKey: request.apiKey,\n      styleGuide: request.styleGuide,\n      scrollDuration: request.scrollDuration,\n      commentDelay: request.commentDelay,\n      maxPosts: request.maxPosts,\n      duplicateWindow: request.duplicateWindow,\n    };\n\n    console.log(\"Background: Saving settings to storage:\", settingsToSave);\n    chrome.storage.local.set(settingsToSave);\n\n    startAutoCommenting(\n      request.styleGuide,\n      request.apiKey,\n      request.scrollDuration,\n      request.commentDelay,\n      request.maxPosts,\n      request.duplicateWindow,\n    );\n    sendResponse({ success: true });\n  } else if (request.action === \"stopAutoCommenting\") {\n    console.log(\"Background: Received stopAutoCommenting request\");\n    // Stop the commenting process immediately\n    autoCommentingState.isRunning = false;\n\n    // Send stop message to content script immediately\n    if (autoCommentingState.feedTabId) {\n      chrome.tabs.sendMessage(autoCommentingState.feedTabId, {\n        action: \"stopCommentingFlow\",\n      });\n\n      // Close the LinkedIn tab\n      chrome.tabs.remove(autoCommentingState.feedTabId).catch(() => {\n        // Tab might already be closed, that's okay\n      });\n    }\n\n    // Clear current run state from storage\n    chrome.storage.local.set({\n      isRunning: false,\n      currentCommentCount: 0,\n    });\n\n    // Reset comment count\n    autoCommentingState.commentCount = 0;\n\n    // Clear original tab reference\n    autoCommentingState.originalTabId = undefined;\n\n    sendStatusUpdate(\"Process stopped and LinkedIn tab closed\", {\n      isRunning: false,\n    });\n    sendResponse({ success: true });\n  } else if (request.action === \"generateComment\") {\n    // Handle comment generation requests from content script\n    console.log(\n      \"Background: Received comment generation request for content:\",\n      request.postContent?.substring(0, 100) + \"...\",\n    );\n\n    generateCommentBackground(request.postContent)\n      .then((comment) => {\n        console.log(\n          \"Background: Sending comment response:\",\n          comment.substring(0, 100) + \"...\",\n        );\n        sendResponse({ comment });\n      })\n      .catch((error) => {\n        console.error(\n          \"Background: Error in comment generation promise:\",\n          error,\n        );\n\n        // Create detailed error object for content script\n        const errorDetails = {\n          message: error instanceof Error ? error.message : String(error),\n          stack: error instanceof Error ? error.stack : undefined,\n          name: error instanceof Error ? error.name : \"Unknown\",\n          apiKey: autoCommentingState.apiKey ? \"Present\" : \"Missing\",\n          styleGuide: autoCommentingState.styleGuide ? \"Present\" : \"Missing\",\n          postContentLength: request.postContent\n            ? request.postContent.length\n            : 0,\n          timestamp: new Date().toISOString(),\n          type: \"openrouter_api_error\",\n        };\n\n        // Send error details to content script\n        if (autoCommentingState.feedTabId) {\n          chrome.tabs\n            .sendMessage(autoCommentingState.feedTabId, {\n              action: \"openrouter_error\",\n              error: errorDetails,\n            })\n            .catch((msgError) => {\n              console.error(\n                \"Background: Failed to send error to content script:\",\n                msgError,\n              );\n            });\n        }\n\n        console.error(\"Background: Sending fallback comment due to error\");\n        sendResponse({\n          comment: \"Great post! Thanks for sharing.\",\n          error: errorDetails,\n        });\n      });\n    return true; // Indicates we will send a response asynchronously\n  } else if (request.action === \"updateCommentCount\") {\n    // Handle comment count updates from content script\n    autoCommentingState.commentCount = request.count;\n    sendStatusUpdate(request.status || `Processed ${request.count} comments`, {\n      commentCount: request.count,\n    });\n    sendResponse({ success: true });\n  } else if (request.action === \"commentingCompleted\") {\n    // Handle completion notification from content script\n    autoCommentingState.isRunning = false;\n\n    // Close the LinkedIn tab when automation completes\n    if (autoCommentingState.feedTabId) {\n      chrome.tabs.remove(autoCommentingState.feedTabId).catch(() => {\n        // Tab might already be closed, that's okay\n        console.log(\"LinkedIn tab was already closed or could not be closed\");\n      });\n    }\n\n    // Clear original tab reference\n    autoCommentingState.originalTabId = undefined;\n\n    sendStatusUpdate(\n      `Commenting completed! LinkedIn tab closed. Check the counts above for total comments posted.`,\n      { isRunning: false },\n    );\n    sendResponse({ success: true });\n  } else if (request.action === \"moveToOriginalTab\") {\n    // Handle request to move back to the original tab\n    console.log(\n      \"Background: Received request to move back to the original tab\",\n    );\n\n    if (autoCommentingState.originalTabId) {\n      // Switch focus to the original tab\n      chrome.tabs\n        .update(autoCommentingState.originalTabId, { active: true })\n        .then(() => {\n          console.log(\n            `âœ… Successfully focused original tab ID: ${autoCommentingState.originalTabId}`,\n          );\n          sendResponse({ success: true });\n        });\n    }\n    return true; // Indicates we will send a response asynchronously\n  } else if (request.action === \"pageReady\") {\n    // Handle signal from content script that LinkedIn page is ready\n    console.log(\"Content script signaled page ready - showing start button\");\n    sendStatusUpdate(\"LinkedIn feed loaded. Showing start button...\");\n\n    if (autoCommentingState.feedTabId) {\n      chrome.tabs.sendMessage(autoCommentingState.feedTabId, {\n        action: \"showStartButton\",\n      });\n      console.log(\"Start button should now be visible in the LinkedIn tab\");\n    }\n\n    sendResponse({ success: true });\n  }\n});\n\n// Handle LinkedIn tab being manually closed\nchrome.tabs.onRemoved.addListener((tabId) => {\n  if (autoCommentingState.feedTabId === tabId) {\n    console.log(\"LinkedIn tab was manually closed\");\n    autoCommentingState.feedTabId = undefined;\n\n    // Stop the automation if it's running\n    if (autoCommentingState.isRunning) {\n      autoCommentingState.isRunning = false;\n\n      // Clear current run state from storage\n      chrome.storage.local.set({\n        isRunning: false,\n        currentCommentCount: 0,\n      });\n\n      // Reset comment count\n      autoCommentingState.commentCount = 0;\n\n      // Clear original tab reference\n      autoCommentingState.originalTabId = undefined;\n\n      sendStatusUpdate(\"LinkedIn tab was closed - automation stopped\", {\n        isRunning: false,\n      });\n    }\n  }\n});\n\nconsole.log(\"EngageKit background script loaded\");\n"],"names":["autoCommentingState","sendStatusUpdate","status","updates","error","generateCommentBackground","postContent","ai","systemPrompt","generatedComment","errorDetails","tabs","_a","msgError","startAutoCommenting","styleGuide","apiKey","scrollDuration","commentDelay","maxPosts","duplicateWindow","currentTabs","feedTab","request","sender","sendResponse","_b","timestamp","tabInfo","settingsToSave","comment","tabId"],"mappings":"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"}