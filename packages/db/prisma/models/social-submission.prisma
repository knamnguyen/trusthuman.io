model SocialSubmission {
  id             String   @id @default(uuid())
  organizationId String
  platform       SocialPlatform
  postUrl        String
  urlNormalized  String   @unique // Normalized URL for global duplicate detection
  status         SubmissionStatus @default(VERIFYING)
  submittedAt    DateTime         @default(now())
  verifiedAt     DateTime?
  lastScannedAt  DateTime?
  nextScanAt     DateTime?
  scanCount      Int              @default(0) // Total scans completed (max 3)
  rescanWorkflowId String?        // DBOS workflow ID for active rescan

  // Verification results
  containsKeyword Boolean  @default(false)
  postText        String?
  likes           Int      @default(0)
  comments        Int      @default(0)
  shares          Int      @default(0)

  // Reward tracking
  daysAwarded        Int        @default(0)
  awardType          AwardType? // null for legacy submissions pre-migration
  creditAmountCents  Int?       // For STRIPE_CREDIT: actual cents credited to Stripe balance

  organization Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)

  @@index([organizationId])
  @@index([status])
  @@index([platform])
}

enum SocialPlatform {
  X
  LINKEDIN
  THREADS
  FACEBOOK
}

enum SubmissionStatus {
  VERIFYING
  VERIFIED
  FAILED
  REVOKED
}

enum AwardType {
  EARNED_DAYS   // FREE org: extends earnedPremiumExpiresAt
  STRIPE_CREDIT // PREMIUM org: Stripe customer balance credit
}
