model Comment {
  id                 String    @id
  postUrn            String
  postContentHtml    String?
  postCreatedAt      DateTime?
  postFullCaption    String
  postCaptionPreview String

  adjacentComments Json?

  authorUrn        String?
  authorName       String?
  authorProfileUrl String?
  authorAvatarUrl  String?
  authorHeadline   String?

  comment           String
  originalAiComment String?
  postAlternateUrns String[]
  commentedAt       DateTime?
  isAutoCommented   Boolean       @default(true)
  status            CommentStatus @default(DRAFT)
  schedulePostAt    DateTime?

  accountId String

  autoCommentRunId String?
  autoCommentError String?

  account        LinkedInAccount? @relation(fields: [accountId], references: [id])
  autoCommentRun AutoCommentRun?  @relation(fields: [autoCommentRunId], references: [id])

  @@index([postUrn])
  @@index([commentedAt])
  @@index([status])
  @@index([postAlternateUrns], type: Gin)
}

enum CommentStatus {
  DRAFT
  SCHEDULED
  QUEUED
  POSTING
  POSTED
  FAILED
  CANCELLED
}

model AutoCommentRun {
  id          String    @id
  accountId   String
  liveUrl     String
  startedAt   DateTime?
  endedAt     DateTime?
  scheduledAt DateTime
  error       String?
  status      String
  comments    Comment[]
  hitlMode    Boolean   @default(false)

  account LinkedInAccount @relation(fields: [accountId], references: [id])
  user    User?           @relation(fields: [userId], references: [id])
  userId  String?
}

model CommentStyle {
  id        String   @id
  userId    String
  name      String
  prompt    String
  createdAt DateTime @default(now())

  user              User                @relation(fields: [userId], references: [id])
  AutoCommentConfig AutoCommentConfig[]
}

model AutoCommentConfig {
  accountId                   String  @id
  userId                      String
  scrollDuration              Int
  commentDelay                Int
  maxPosts                    Int
  duplicateWindow             Int
  finishListModeEnabled       Boolean
  commentAsCompanyEnabled     Boolean
  timeFilterEnabled           Boolean
  minPostAge                  Int?
  manualApproveEnabled        Boolean
  authenticityBoostEnabled    Boolean
  targetListId                String?
  defaultCommentStyle         String?
  commentStyleId              String?
  commentProfileName          String?
  languageAwareEnabled        Boolean
  blacklistEnabled            Boolean
  skipPromotedPostsEnabled    Boolean
  skipFriendActivitiesEnabled Boolean
  skipCompanyPagesEnabled     Boolean
  hitlMode                    Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user            User            @relation(fields: [userId], references: [id], onDelete: Cascade)
  linkedInAccount LinkedInAccount @relation(fields: [accountId], references: [id], onDelete: Cascade)
  commentStyle    CommentStyle?   @relation(fields: [commentStyleId], references: [id], onDelete: SetNull)
}
