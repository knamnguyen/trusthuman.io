model Comment {
  id                String    @id
  postUrn           String    @default("")
  postUrl           String    @default("")
  postCreatedAt     DateTime?
  postFullCaption   String
  postComments      Json?
  authorName        String?
  authorProfileUrl  String?
  authorAvatarUrl   String?
  authorHeadline    String?
  postAlternateUrns String[]  @default([""])

  peakTouchScore    Int?
  comment           String
  commentUrn        String?
  commentUrl        String?
  originalAiComment String?
  commentedAt       DateTime?

  isAutoCommented Boolean       @default(true)
  status          CommentStatus @default(DRAFT)
  schedulePostAt  DateTime?

  accountId String

  autoCommentRunId String?
  autoCommentError String?

  account        LinkedInAccount? @relation(fields: [accountId], references: [id])
  autoCommentRun AutoCommentRun?  @relation(fields: [autoCommentRunId], references: [id])

  // Track which CommentStyle (persona) was used to generate this comment
  commentStyleId String?
  commentStyle   CommentStyle? @relation(fields: [commentStyleId], references: [id], onDelete: SetNull)

  // Snapshot of the style config at generation time (in case style is deleted/modified later)
  // Contains: { name, content, maxWords, creativity }
  styleSnapshot  Json?

  @@index([postUrn])
  @@index([commentStyleId])
  @@index([commentedAt])
  @@index([status])
  @@index([postAlternateUrns], type: Gin)
  // Composite indexes for achievements queries
  @@index([accountId, status, peakTouchScore])
  @@index([accountId, status, commentedAt])
  @@index([accountId, status, authorProfileUrl])
}

enum CommentStatus {
  DRAFT
  SCHEDULED
  QUEUED
  POSTING
  POSTED
  FAILED
  CANCELLED
}
